# 歩行パターン生成プログラム by Capture Point タスク整理メモ

- 変数初期化
    - 終端CP
        - 現在の目標CPとする
        - 経験的に決定？
    - 遊脚着地位置
        - x, y, theta
    - 片足支持期、両足支持期
    - 重心高さ
        - sonyでは初期姿勢でのCoM.zを利用
    - 足上げ高さ

----

- 現在CPの計算
    - 初期値として何か入れといて、初回以降は前回の終端CPを使用する
        - 初期値 : 初期重心位置
- 目標ZMPの計算
    - sony::PlanCP  rfzmp（軌道）
    - 重心高さ、dT、終端CP（sonyでは遊脚着地位置？）、現在CP
- 目標CP軌道の計算
    - dTごとに計算する = 1制御周期後の目標位置を計算し続ける(CPT)
        - 外乱に応じた（？）理想的なCP軌道を再構成可
        - ロボットの状態値を使うのは現在CoMのみ
            - -> CPTにするとき、現在CP計算から毎回やる？
    - sony::PlanCP  cp_deque
    - 目標ZMP、現在CP
- 目標CoM軌道の計算
    - CoM速度ベクトル : 前回の目標CoM位置、目標CP(t)
    - 上を積分してCoM位置計算

----

- 目標脚軌道の計算
    - ZmpPlanner::calcSwingLegCP
    - 一歩分一気に生成
    - X、Y
        - 両足支持期 : 初期位置 -> 初期位置
        - 片足支持期 : 初期位置 -> 目標足位置
    - Z
        - 両足支持期 : 0 -> 0
        - 片足支持期 : 0 -> 足上げ高さ -> 0した
            - 半楕円型に生成した方がいいかも？
    - Roll
        - 多分全部ゼロでok
    - Pitch
    - Yow
        - 両足支持期 : 初期角度 -> 初期角度
        - 片足支持期 : 一次関数的にthetaに近づける